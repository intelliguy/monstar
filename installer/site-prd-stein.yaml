---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: ceph-provisioners
data:
  chart_name: ceph-provisioners
  release: ceph-provisioners
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
  values:
    images:
      tags:
        ceph_bootstrap: admin-prd:5000/openstackhelm/ceph-daemon:ubuntu_bionic-20200217
        ceph_cephfs_provisioner: admin-prd:5000/openstackhelm/ceph-cephfs-provisioner:ubuntu_bionic-20200217
        ceph_config_helper: admin-prd:5000/port/ceph-config-helper:v1.17.6
        ceph_rbd_provisioner: admin-prd:5000/openstackhelm/ceph-rbd-provisioner:ubuntu_bionic-20200217
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
      pull_policy: IfNotPresent
    deployment:
      ceph: false
      client_secrets: true
      rbd_provisioner: false
      cephfs_provisioner: false
    storageclass:
      rbd:
        provision_storage_class: false
      cephfs:
        provision_storage_class: false
    conf:
      ceph:
        global:
          mon_host: TACO_MON_HOST
    manifests:
      configmap_bin: false
      configmap_bin_common: false
      configmap_etc: true
      deployment_rbd_provisioner: false
      deployment_cephfs_provisioner: false
      job_bootstrap: false
      job_cephfs_client_key: false
      job_image_repo_sync: false
      job_namespace_client_key_cleaner: false
      job_namespace_client_key: false
      storageclass_cephfs: false
      storageclass_rbd: false
      helm_tests: false
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: ceph-provisioners
    reference: master
  dependencies:
    - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: cinder
data:
  chart_name: cinder
  release: cinder
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
    pre:
      delete:
      - name: cinder-bootstrap
        type: job
        labels:
          application: cinder
          component: bootstrap
      - name: cinder-db-init
        type: job
        labels:
          application: cinder
          component: db-init
      - name: cinder-db-sync
        type: job
        labels:
          application: cinder
          component: db-sync
      - name: cinder-ks-endpoints
        type: job
        labels:
          application: cinder
          component: ks-endpoints
      - name: cinder-ks-service
        type: job
        labels:
          application: cinder
          component: ks-service
      - name: cinder-ks-user
        type: job
        labels:
          application: cinder
          component: ks-user
  values:
    endpoints:
      oslo_db:
        auth:
          admin:
            username: root
            password: password
          cinder:
            username: cinder
            password: password
      oslo_messaging:
        auth:
          admin:
            username: rabbitmq
            password: password
          cinder:
            username: cinder
            password: password
        statefulset: null
      identity:
        auth:
          admin:
            username: admin
            password: password
          cinder:
            username: cinder
            password: password
      volume:
        path:
          default: /v2/%(tenant_id)s
    images:
      tags:
        test: admin-prd:5000/xrally/xrally-openstack:1.3.0
        db_init: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        cinder_db_sync: admin-prd:5000/stein/ubuntu-source-cinder-api:taco-0.1.0
        db_drop: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        rabbit_init: admin-prd:5000/rabbitmq:3.7-management
        ks_user: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_service: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_endpoints: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        cinder_api: admin-prd:5000/stein/ubuntu-source-cinder-api:taco-0.1.0
        bootstrap: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        cinder_scheduler: admin-prd:5000/stein/ubuntu-source-cinder-scheduler:taco-0.1.0
        cinder_volume: admin-prd:5000/stein/ubuntu-source-cinder-volume:taco-0.1.0
        cinder_volume_usage_audit: admin-prd:5000/stein/ubuntu-source-cinder-volume:taco-0.1.0
        cinder_storage_init: admin-prd:5000/port/ceph-config-helper:v1.17.6
        cinder_backup: admin-prd:5000/stein/ubuntu-source-cinder-backup:taco-0.1.0
        cinder_backup_storage_init: admin-prd:5000/port/ceph-config-helper:v1.17.6
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
      pull_policy: Always
    pod:
      security_context:
        cinder:
          pod:
            runAsUser: 42407
        cinder_api:
          pod:
            runAsUser: 42407
        cinder_backup:
          pod:
            runAsUser: 42407
        cinder_scheduler:
          pod:
            runAsUser: 42407
        cinder_volume:
          pod:
            runAsUser: 42407
      replicas:
        api: 3
        backup: 1
        scheduler: 3
        volume: 1
    conf:
      logging:
        loggers:
          keys:
          - root
          - cinder
          - oslo_service
        logger_oslo_service:
          level: DEBUG
          handlers: stderr
          qualname: oslo_service
        logger_cinder:
          level: DEBUG
      ceph:
        admin_keyring: TACO_ADMIN_KEYRING
        enabled: true
        pools:
          volumes:
            app_name: cinder-volume
      cinder:
        DEFAULT:
          backup_driver: cinder.backup.drivers.ceph.CephBackupDriver
          backup_ceph_user: cinder
          backup_ceph_pool: backups
          osapi_volume_workers: 8
      backends:
        rbd1:
          rbd_pool: volumes
          rbd_secret_uuid: 582393ff-9a5c-4a2e-ae0d-86ec18c36afc
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm
    subpath: cinder
    reference: master
  test:
    enabled: true
    timeout: 3600
  dependencies:
  - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: etcd
data:
  chart_name: etcd
  release: etcd
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
  values:
    images:
      tags:
        etcd: admin-prd:5000/google_containers/etcd-amd64:3.2.24
        image_repo_sync: admin-prd:5000/docker:17.07.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
      pull_policy: IfNotPresent
    pod:
      replicas:
        etcd: 1
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: etcd
    reference: master
  dependencies:
    - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: glance
data:
  chart_name: glance
  release: glance
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
    pre:
      delete:
      - name: glance-bootstrap
        type: job
        labels:
          application: glance
          component: bootstrap
      - name: glance-storage-init
        type: job
        labels:
          application: glance
          component: storage-init
      - name: glance-db-init
        type: job
        labels:
          application: glance
          component: db-init
      - name: glance-db-sync
        type: job
        labels:
          application: glance
          component: db-sync
      - name: glance-ks-endpoints
        type: job
        labels:
          application: glance
          component: ks-endpoints
      - name: glance-ks-service
        type: job
        labels:
          application: glance
          component: ks-service
      - name: glance-ks-user
        type: job
        labels:
          application: glance
          component: ks-user
  values:
    endpoints:
      identity:
        auth:
          admin:
            username: admin
            password: password
          glance:
            username: glance
            password: password
      oslo_db:
        auth:
          admin:
            username: root
            password: password
          glance:
            username: glance
            password: password
      oslo_messaging:
        auth:
          admin:
            username: rabbitmq
            password: password
          glance:
            username: glance
            password: password
        statefulset: null
    images:
      tags:
        test: admin-prd:5000/xrally/xrally-openstack:1.3.0
        glance_storage_init: admin-prd:5000/port/ceph-config-helper:v1.17.6
        glance_metadefs_load: admin-prd:5000/stein/ubuntu-source-glance-api:taco-0.1.0
        db_init: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        glance_db_sync: admin-prd:5000/stein/ubuntu-source-glance-api:taco-0.1.0
        db_drop: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_user: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_service: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_endpoints: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        rabbit_init: admin-prd:5000/rabbitmq:3.7-management
        glance_api: admin-prd:5000/stein/ubuntu-source-glance-api:taco-0.1.0
        glance_registry: admin-prd:5000/stein/ubuntu-source-glance-registry:taco-0.1.0
        bootstrap: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
      pull_policy: Always
    pod:
      security_context:
        glance:
          pod:
            runAsUser: 42415
      replicas:
        api: 3
        registry: 3
    network:
      api:
        ingress:
          annotations:
            nginx.ingress.kubernetes.io/proxy-body-size: 102400M
    storage: rbd
    conf:
      ceph:
        enabled: true
        admin_keyring: TACO_ADMIN_KEYRING
      glance:
        glance_store:
          rbd_store_user: glance
          rbd_store_pool: images
        DEFAULT:
          show_image_direct_url: true
          show_multiple_locations: true
          workers: 8
    bootstrap:
      enabled: false
      structured:
        images:
          cirros:
            name: Cirros 0.4.0 64-bit
            id: 201084fc-c276-4744-8504-cb974dbb3610
            source_url: http://download.cirros-cloud.net/0.4.0/
            image_file: cirros-0.4.0-x86_64-disk.img
            private: false
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm
    subpath: glance
    reference: master
  test:
    enabled: false
    timeout: 3600
  dependencies:
  - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: heat
data:
  chart_name: heat
  release: heat
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
    pre:
      delete:
        - type: job
          labels:
            application: heat
            component: bootstrap
        - type: job
          labels:
            application: heat
            component: db-init
        - type: job
          labels:
            application: heat
            component: db-sync
        - type: job
          labels:
            application: heat
            component: ks-user
        - type: job
          labels:
            application: heat
            component: ks-service
        - type: job
          labels:
            application: heat
            component: ks-endpoints
        - type: job
          labels:
            application: heat
            component: trusts
  values:
    endpoints:
      cluster_domain_suffix: cluster.local
    images:
      tags:
        test: admin-prd:5000/xrally/xrally-openstack:1.3.0
        bootstrap: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        db_init: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        heat_db_sync: admin-prd:5000/stein/ubuntu-source-heat-api:taco-0.1.0
        db_drop: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_user: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_service: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_endpoints: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        heat_api: admin-prd:5000/stein/ubuntu-source-heat-api:taco-0.1.0
        heat_cfn: admin-prd:5000/stein/ubuntu-source-heat-api:taco-0.1.0
        heat_cloudwatch: admin-prd:5000/stein/ubuntu-source-heat-api:taco-0.1.0
        heat_engine: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        heat_engine_cleaner: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        rabbit_init: admin-prd:5000/rabbitmq:3.7-management
        image_repo_sync: admin-prd:5000/docker:17.07.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        heat_purge_deleted: admin-prd:5000/openstackhelm/heat:ocata-ubuntu_xenial
      pull_policy: Always
    pod:
      security_context:
        heat:
          pod:
            runAsUser: 42418
      replicas:
        api: 3
        cfn: 3
        cloudwatch: 3
        engine: 3
    endpoints:
      identity:
        auth:
          admin:
            username: admin
            password: password
          heat:
            username: heat
            password: password
          heat_trustee:
            username: heat-trust
            password: password
          heat_stack_user:
            username: heat-domain
            password: password
      oslo_db:
        auth:
          admin:
            username: root
            password: password
          heat:
            username: heat
            password: password
      oslo_messaging:
        auth:
          admin:
            username: rabbitmq
            password: password
          heat:
            username: heat
            password: password
        statefulset: null
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm
    subpath: heat
    reference: master
  test:
    enabled: true
    timeout: 3600
  dependencies:
    - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: helm-toolkit
data:
  chart_name: helm-toolkit
  release: helm-toolkit
  namespace: helm-tookit
  values: {}
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: helm-toolkit
    reference: master
  dependencies: []
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: horizon
data:
  chart_name: horizon
  release: horizon
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
    pre:
      delete:
      - type: job
        labels:
          application: horizon
          component: db-init
      - type: job
        labels:
          application: horizon
          component: db-sync
  values:
    endpoints:
      oslo_db:
        auth:
          admin:
            username: root
            password: password
          horizon:
            username: horizon
            password: password
    images:
      tags:
        db_init: admin-prd:5000/stein/ubuntu-source-horizon:taco-0.1.0
        db_drop: admin-prd:5000/stein/ubuntu-source-horizon:taco-0.1.0
        horizon_db_sync: admin-prd:5000/stein/ubuntu-source-horizon:taco-0.1.0
        horizon: admin-prd:5000/stein/ubuntu-source-horizon:taco-0.1.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        test: admin-prd:5000/openstackhelm/osh-selenium:latest-ubuntu_bionic
      pull_policy: Always
    pod:
      security_context:
        horizon:
          pod:
            runAsUser: 42420
      replicas:
        server: 1
    network:
      node_port:
        enabled: true
        port: 31000
      api:
        ingress:
          annotations:
            nginx.ingress.kubernetes.io/proxy-body-size: 102400M
    conf:
      software:
        apache2:
          site_dir: /etc/apache2/sites-enabled
      horizon:
        apache: |
          Listen 0.0.0.0:{{ tuple "dashboard" "internal" "web" . | include "helm-toolkit.endpoints.endpoint_port_lookup" }}

          LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
          LogFormat "%{X-Forwarded-For}i %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" proxy

          SetEnvIf X-Forwarded-For "^.*\..*\..*\..*" forwarded
          CustomLog /dev/stdout combined env=!forwarded
          CustomLog /dev/stdout proxy env=forwarded

          <VirtualHost *:{{ tuple "dashboard" "internal" "web" . | include "helm-toolkit.endpoints.endpoint_port_lookup" }}>
              WSGIScriptReloading On
              WSGIDaemonProcess horizon-http processes=5 threads=1 user=horizon group=horizon display-name=%{GROUP} python-path=/var/lib/kolla/venv/lib/python2.7/site-packages
              WSGIProcessGroup horizon-http
              WSGIScriptAlias / /var/www/cgi-bin/horizon/django.wsgi
              WSGIPassAuthorization On
              RewriteEngine on
              RewriteCond %{REQUEST_METHOD} !^(POST|PUT|GET|DELETE)
              RewriteRule .* - [F]

              <Location "/">
                  Require all granted
              </Location>

              Alias /static /var/www/html/horizon
              <Location "/static">
                  SetHandler None
              </Location>

              <IfVersion >= 2.4>
                ErrorLogFormat "%{cu}t %M"
              </IfVersion>
              ErrorLog /dev/stdout
              TransferLog /dev/stdout

              SetEnvIf X-Forwarded-For "^.*\..*\..*\..*" forwarded
              CustomLog /dev/stdout combined env=!forwarded
              CustomLog /dev/stdout proxy env=forwarded
          </Virtualhost>
        local_settings:
          config:
            openstack_neutron_network:
              enable_router: "False"
              enable_quotas: "True"
              enable_ipv6: "False"
              enable_distributed_router: "False"
              enable_ha_router: "False"
              enable_lb: "False"
              enable_firewall: "False"
              enable_vpn: "False"
              enable_fip_topology_check: "False"
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm
    subpath: horizon
    reference: master
  dependencies:
  - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: ingress
data:
  chart_name: ingress
  release: ingress
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
  values:
    endpoints:
      cluster_domain_suffix: cluster.local
    images:
      tags:
        entrypoint: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        ingress: admin-prd:5000/kubernetes-ingress-controller/nginx-ingress-controller:0.23.0
        ingress_module_init: admin-prd:5000/stein/ubuntu-source-neutron-server:taco-0.1.0
        ingress_routed_vip: admin-prd:5000/stein/ubuntu-source-neutron-server:taco-0.1.0
        error_pages: admin-prd:5000/google_containers/defaultbackend:1.0
        keepalived: admin-prd:5000/osixia/keepalived:1.4.5
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
      pull_policy: Always
    network:
      host_namespace: true
    monitoring:
      prometheus:
        enabled: true
        ingress_exporter:
          scrape: true
        config:
          worker-processes: 8
    config:
      worker-processes: 8
    pod:
      replicas:
        ingress: 3
        error_page: 1
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: ingress
    reference: master
  dependencies:
  - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: keystone
data:
  chart_name: keystone
  release: keystone
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
    pre:
      delete:
      - name: keystone-bootstrap
        type: job
        labels:
          application: keystone
          component: bootstrap
      - name: keystone-credential-setup
        type: job
        labels:
          application: keystone
          component: credential-setup
      - name: keystone-db-init
        type: job
        labels:
          application: keystone
          component: db-init
      - name: keystone-db-sync
        type: job
        labels:
          application: keystone
          component: db-sync
      - name: keystone-fernet-setup
        type: job
        labels:
          application: keystone
          component: fernet-setup
      - name: keystone-domain-manage
        type: job
        labels:
          application: keystone
          component: domain-manage
  values:
    endpoints:
      identity:
        auth:
          admin:
            username: admin
            password: password
      oslo_db:
        auth:
          admin:
            username: root
            password: password
          keystone:
            username: keystone
            password: password
      oslo_messaging:
        auth:
          admin:
            username: rabbitmq
            password: password
          keystone:
            username: keystone
            password: password
        statefulset: null
    images:
      tags:
        bootstrap: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        test: admin-prd:5000/xrally/xrally-openstack:1.3.0
        db_init: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        keystone_db_sync: admin-prd:5000/stein/ubuntu-source-keystone:taco-0.1.0
        db_drop: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_user: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        rabbit_init: admin-prd:5000/rabbitmq:3.7-management
        keystone_fernet_setup: admin-prd:5000/stein/ubuntu-source-keystone:taco-0.1.0
        keystone_fernet_rotate: admin-prd:5000/stein/ubuntu-source-keystone:taco-0.1.0
        keystone_credential_setup: admin-prd:5000/stein/ubuntu-source-keystone:taco-0.1.0
        keystone_credential_rotate: admin-prd:5000/stein/ubuntu-source-keystone:taco-0.1.0
        keystone_api: admin-prd:5000/stein/ubuntu-source-keystone:taco-0.1.0
        keystone_domain_manage: admin-prd:5000/stein/ubuntu-source-keystone:taco-0.1.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
        keystone_credential_cleanup: admin-prd:5000/openstackhelm/heat:ocata-ubuntu_xenial
      pull_policy: Always
    conf:
      keystone:
        DEFAULT:
          debug: true
      wsgi_keystone: |
        {{- $portInt := tuple "identity" "internal" "api" $ | include "helm-toolkit.endpoints.endpoint_port_lookup" }}

        Listen 0.0.0.0:{{ $portInt }}

        LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
        LogFormat "%{X-Forwarded-For}i %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" proxy

        SetEnvIf X-Forwarded-For "^.*\..*\..*\..*" forwarded
        CustomLog /dev/stdout combined env=!forwarded
        CustomLog /dev/stdout proxy env=forwarded

        <VirtualHost *:{{ $portInt }}>
            WSGIDaemonProcess keystone-public processes=5 threads=5 user=keystone group=keystone display-name=%{GROUP}
            WSGIProcessGroup keystone-public
            WSGIScriptAlias / /var/www/cgi-bin/keystone/keystone-wsgi-public
            WSGIApplicationGroup %{GLOBAL}
            WSGIPassAuthorization On
            <IfVersion >= 2.4>
              ErrorLogFormat "%{cu}t %M"
            </IfVersion>
            ErrorLog /dev/stdout

            SetEnvIf X-Forwarded-For "^.*\..*\..*\..*" forwarded
            CustomLog /dev/stdout combined env=!forwarded
            CustomLog /dev/stdout proxy env=forwarded
        </VirtualHost>
    pod:
      security_context:
        keystone:
          pod:
            runAsUser: 42425
      replicas:
        api: 3
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm
    subpath: keystone
    reference: master
  test:
    enabled: true
    timeout: 3600
  dependencies:
  - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: libvirt
data:
  chart_name: libvirt
  release: libvirt
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
  values:
    endpoints:
      cluster_domain_suffix: cluster.local
    release_group: null
    images:
      tags:
        image_repo_sync: admin-prd:5000/docker:17.07.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        libvirt: admin-prd:5000/stein/ubuntu-source-nova-libvirt:taco-0.1.0
        ceph_config_helper: admin-prd:5000/port/ceph-config-helper:v1.17.6
      pull_policy: Always
    network:
      backend:
      - linuxbridge
    conf:
      ceph:
        enabled: true
        admin_keyring: TACO_ADMIN_KEYRING
        cinder:
          user: cinder
          keyring: AQAin8tU0CFgEhAATb7sYgtWsh+S5HEbg6MrGg==
          secret_uuid: 582393ff-9a5c-4a2e-ae0d-86ec18c36afc
      libvirt:
        listen_addr: 0.0.0.0
        log_level: 3
    manifests:
      configmap_bin: true
      configmap_etc: true
      daemonset_libvirt: true
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: libvirt
    reference: master
  dependencies:
  - helm-toolkit
---
schema: armada/Manifest/v1
metadata:
  schema: metadata/Document/v1
  name: prd-manifest
data:
  release_prefix: prd
  chart_groups:
  - openstack-infra
  - openstack-base
  - openstack-compute-kit
  - openstack-addon
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: mariadb
data:
  chart_name: mariadb
  release: mariadb
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
    pre:
      delete:
      - name: exporter-create-sql-user
        type: job
        labels:
          application: prometheus_mysql_exporter
          component: create-sql-user
  values:
    endpoints:
      oslo_db:
        auth:
          admin:
            username: root
            password: password
    images:
      tags:
        mariadb: admin-prd:5000/openstackhelm/mariadb:10.2.18
        mariadb_backup: admin-prd:5000/openstackhelm/mariadb:ubuntu_xenial-20191031
        scripted_test: admin-prd:5000/openstackhelm/mariadb:ubuntu_xenial-20191031
        ingress: admin-prd:5000/kubernetes-ingress-controller/nginx-ingress-controller:0.9.0
        error_pages: admin-prd:5000/google_containers/defaultbackend:1.0
        prometheus_create_mysql_user: admin-prd:5000/mariadb:10.2.13
        prometheus_mysql_exporter: admin-prd:5000/prom/mysqld-exporter:v0.10.0
        prometheus_mysql_exporter_helm_tests: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
      pull_policy: Always
    pod:
      replicas:
        server: 3
    volume:
      enabled: true
      class_name: rbd
    monitoring:
      prometheus:
        enabled: true
        mysqld_exporter:
          scrape: true
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: mariadb
    reference: master
  test:
    enabled: true
    timeout: 3600
  dependencies:
  - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: memcached
data:
  chart_name: memcached
  release: memcached
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
  values:
    images:
      tags:
        memcached: admin-prd:5000/memcached:1.5.5
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        prometheus_memcached_exporter: admin-prd:5000/prom/memcached-exporter:v0.4.1
        image_repo_sync: admin-prd:5000/docker:17.07.0
      pull_policy: IfNotPresent
    pod:
      replicas:
        server: 1
    monitoring:
      prometheus:
        enabled: true
        memcached_exporter:
          scrape: true
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: memcached
    reference: master
  dependencies:
  - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: neutron
data:
  chart_name: neutron
  release: neutron
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
    pre:
      delete:
      - name: neutron-db-init
        type: job
        labels:
          application: neutron
          component: db-init
      - name: neutron-db-sync
        type: job
        labels:
          application: neutron
          component: db-sync
      - name: neutron-ks-endpoints
        type: job
        labels:
          application: neutron
          component: ks-endpoints
      - name: neutron-ks-service
        type: job
        labels:
          application: neutron
          component: ks-service
      - name: neutron-ks-user
        type: job
        labels:
          application: neutron
          component: ks-user
  values:
    endpoints:
      oslo_db:
        auth:
          admin:
            username: root
            password: password
          neutron:
            username: neutron
            password: password
      oslo_messaging:
        auth:
          admin:
            username: rabbitmq
            password: password
          neutron:
            username: neutron
            password: password
        statefulset: null
      identity:
        name: keystone
        auth:
          admin:
            username: admin
            password: password
          neutron:
            username: neutron
            password: password
          nova:
            username: nova
            password: password
    images:
      tags:
        bootstrap: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        test: admin-prd:5000/xrally/xrally-openstack:1.3.0
        purge_test: admin-prd:5000/openstackhelm/ospurge:latest
        db_init: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        neutron_db_sync: admin-prd:5000/stein/ubuntu-source-neutron-server:taco-0.1.0
        db_drop: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_user: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_service: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_endpoints: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        neutron_server: admin-prd:5000/stein/ubuntu-source-neutron-server:taco-0.1.0
        neutron_dhcp: admin-prd:5000/stein/ubuntu-source-neutron-dhcp-agent:taco-0.1.0
        neutron_metadata: admin-prd:5000/stein/ubuntu-source-neutron-metadata-agent:taco-0.1.0
        neutron_l3: admin-prd:5000/stein/ubuntu-source-neutron-l3-agent:taco-0.1.0
        neutron_openvswitch_agent: admin-prd:5000/stein/ubuntu-source-neutron-openvswitch-agent:taco-0.1.0
        neutron_linuxbridge_agent: admin-prd:5000/stein/ubuntu-source-neutron-linuxbridge-agent:taco-0.1.0
        neutron_sriov_agent: admin-prd:5000/stein/ubuntu-source-neutron-sriov-agent:taco-0.1.0
        neutron_sriov_agent_init: admin-prd:5000/stein/ubuntu-source-neutron-sriov-agent:taco-0.1.0
        neutron_bagpipe_bgp: admin-prd:5000/stein/ubuntu-source-neutron-server:taco-0.1.0
        neutron_ironic_agent: admin-prd:5000/stein/ubuntu-source-neutron-server:taco-0.1.0
        neutron_netns_cleanup_cron: admin-prd:5000/stein/ubuntu-source-neutron-server:taco-0.1.0
        neutron_l2gw: admin-prd:5000/stein/ubuntu-source-neutron-server:taco-0.1.0
        rabbit_init: admin-prd:5000/rabbitmq:3.7-management
        image_repo_sync: admin-prd:5000/docker:17.07.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
      pull_policy: Always
    pod:
      replicas:
        server: 3
      user:
        neutron:
          uid: 42435
      security_context:
        neutron:
          pod:
            runAsUser: 42435
        neutron_dhcp_agent:
          pod:
            runAsUser: 42435
        neutron_l2gw_agent:
          pod:
            runAsUser: 42435
        neutron_bagpipe_bgp:
          pod:
            runAsUser: 42435
        neutron_l3_agent:
          pod:
            runAsUser: 42435
        neutron_lb_agent:
          pod:
            runAsUser: 42435
        neutron_metadata_agent:
          pod:
            runAsUser: 42435
        neutron_ovs_agent:
          pod:
            runAsUser: 42435
        neutron_server:
          pod:
            runAsUser: 42435
        neutron_sriov_agent:
          pod:
            runAsUser: 42435
      probes:
        dhcp_agent:
          dhcp_agent:
            readiness:
              enabled: false
            liveness:
              enabled: false
        l3_agent:
          l3_agent:
            readiness:
              enabled: false
            liveness:
              enabled: false
        metadata_agent:
          metadata_agent:
            readiness:
              enabled: false
            liveness:
              enabled: false
        ovs_agent:
          ovs_agent:
            liveness:
              enabled: false
        sriov_agent:
          sriov_agent:
            readiness:
              enabled: false
      lifecycle:
        upgrades:
          daemonsets:
            dhcp_agent:
              enabled: true
    network:
      backend:
      - openvswitch
      share_namespaces: true
      auto_bridge_add: null
      interface:
        tunnel: null
    conf:
      paste:
        composite:neutronapi_v2_0:
          keystone: cors http_proxy_to_wsgi request_id catch_errors authtoken keystonecontext extensions neutronapiapp_v2_0
        app:neutronversions:
          paste.app_factory: neutron.pecan_wsgi.app:versions_factory
      neutron_sudoers: |
        # This sudoers file supports rootwrap-daemon for both Kolla and LOCI Images.
        Defaults !requiretty
        Defaults secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin:/var/lib/openstack/bin:/var/lib/kolla/venv/bin"
        neutron ALL = (root) NOPASSWD: /var/lib/kolla/venv/bin/neutron-rootwrap /etc/neutron/rootwrap.conf *, /var/lib/openstack/bin/neutron-rootwrap /etc/neutron/rootwrap.conf *, /var/lib/kolla/venv/bin/neutron-rootwrap-daemon /etc/neutron/rootwrap.conf, /var/lib/openstack/bin/neutron-rootwrap-daemon /etc/neutron/rootwrap.conf, /var/lib/kolla/venv/bin/privsep-helper /etc/neutron/rootwrap.conf *
      neutron:
        DEFAULT:
          core_plugin: ml2
          l3_ha: false
          global_physnet_mtu: 9000
          service_plugins: trunk, segments
          interface_driver: linuxbridge
          api_workers: 8
        agent:
          root_helper: sudo /var/lib/kolla/venv/bin/neutron-rootwrap /etc/neutron/rootwrap.conf
        placement:
          auth_version: v3
          auth_type: password
          auth_uri: http://keystone-api.openstack.svc.cluster.local:5000/v3
          auth_url: http://keystone-api.openstack.svc.cluster.local:5000/v3
          endpoint_type: internal
          project_domain_name: service
          project_name: service
          user_domain_name: service
          region_name: RegionOne
          password: password
          username: nova
      plugins:
        ml2_conf:
          ml2:
            mechanism_drivers: linuxbridge
            type_drivers: flat, vlan
            tenant_network_types:
          ml2_type_flat:
            flat_networks: provider-97, provider-98, provider-197, provider-198, provider-199, provider-200
          ml2_type_vlan:
            network_vlan_ranges:
        openvswitch_agent:
          ovs:
            bridge_mappings:
          securitygroup:
            firewall_driver: openvswitch
        linuxbridge_agent:
          linux_bridge:
            physical_interface_mappings:
            bridge_mappings:
            bridge_mapping:
          securitygroup:
            firewall_driver: iptables
        ml2_conf_sriov: {}
        macvtap_agent: {}
      dhcp_agent:
        DEFAULT:
          force_metadata: false
          enable_isolated_metadata: false
      metering_agent: {}
      overrides:
        neutron_lb-agent:
          labels:
          - label:
              key: location
              values:
              - r06
            conf:
              plugins:
                linuxbridge_agent:
                  linux_bridge:
                    physical_interface_mappings: provider-97:bond1.97,provider-197:bond1.197,provider-199:bond1.199
          - label:
              key: location
              values:
              - r04
            conf:
              plugins:
                linuxbridge_agent:
                  linux_bridge:
                    physical_interface_mappings: provider-98:eno50.98,provider-198:eno50.198,provider-200:eno50.200
    manifests:
      daemonset_lb_agent: true
      daemonset_dhcp_agent: true
      daemonset_metadata_agent: false
      daemonset_ovs_agent: false
      daemonset_sriov_agent: false
      daemonset_l3_agent: false
    labels:
      agent:
        dhcp:
          node_selector_key: openstack-network-node
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm
    subpath: neutron
    reference: master
  test:
    enabled: true
    timeout: 3600
  dependencies:
  - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: nfs-client-provisioner
data:
  chart_name: nfs-client-provisioner
  release: nfs-client-provisioner
  namespace: kube-system
  values:
    nfs:
      server: x.x.x.x
      path: nfs/
  source:
    type: local
    location: https://tde.sktelecom.com/stash/scm/oreotools/helm-charts.git
    subpath: stable/nfs-client-provisioner
  dependencies: []
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: nova
data:
  chart_name: nova
  release: nova
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
    pre:
      delete:
      - name: nova-bootstrap
        type: job
        labels:
          application: nova
          component: bootstrap
      - name: nova-cell-setup
        type: job
        labels:
          application: nova
          component: cell-setup
      - name: nova-db-init
        type: job
        labels:
          application: nova
          component: db-init
      - name: nova-db-sync
        type: job
        labels:
          application: nova
          component: db-sync
      - name: nova-ks-endpoints
        type: job
        labels:
          application: nova
          component: ks-endpoints
      - name: nova-ks-service
        type: job
        labels:
          application: nova
          component: ks-service
      - name: nova-ks-user
        type: job
        labels:
          application: nova
          component: ks-user
      - name: placement-ks-endpoints
        type: job
        labels:
          application: placement
          component: ks-endpoints
      - name: placement-ks-service
        type: job
        labels:
          application: placement
          component: ks-service
      - name: placement-ks-user
        type: job
        labels:
          application: placement
          component: ks-user
  values:
    endpoints:
      oslo_db:
        auth:
          admin:
            username: root
            password: password
          nova:
            username: nova
            password: password
      oslo_db_api:
        auth:
          admin:
            username: root
            password: password
          nova:
            username: nova
            password: password
      oslo_db_cell0:
        auth:
          admin:
            username: root
            password: password
          nova:
            username: nova
            password: password
      oslo_messaging:
        auth:
          admin:
            username: rabbitmq
            password: password
          nova:
            username: nova
            password: password
        statefulset: null
      identity:
        auth:
          admin:
            username: admin
            password: password
          nova:
            username: nova
            password: password
          neutron:
            username: neutron
            password: password
          ironic:
            username: ironic
            password: password
          placement:
            username: placement
            password: password
    images:
      tags:
        test: admin-prd:5000/xrally/xrally-openstack:1.3.0
        db_drop: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        db_init: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_user: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_service: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        ks_endpoints: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        nova_api: admin-prd:5000/stein/ubuntu-source-nova-api:taco-0.1.0
        nova_cell_setup: admin-prd:5000/stein/ubuntu-source-nova-api:taco-0.1.0
        nova_cell_setup_init: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        nova_compute: admin-prd:5000/stein/ubuntu-source-nova-compute:taco-0.1.0
        nova_compute_ironic: admin-prd:5000/stein/ubuntu-source-nova-compute-ironic:taco-0.1.0
        nova_compute_ssh: admin-prd:5000/stein/ubuntu-source-nova-ssh:taco-0.1.0
        nova_conductor: admin-prd:5000/stein/ubuntu-source-nova-conductor:taco-0.1.0
        nova_consoleauth: admin-prd:5000/stein/ubuntu-source-nova-consoleauth:taco-0.1.0
        nova_db_sync: admin-prd:5000/stein/ubuntu-source-nova-api:taco-0.1.0
        nova_novncproxy: admin-prd:5000/stein/ubuntu-source-nova-novncproxy:taco-0.1.0
        nova_novncproxy_assets: admin-prd:5000/stein/ubuntu-source-nova-novncproxy:taco-0.1.0
        nova_placement: admin-prd:5000/stein/ubuntu-source-nova-placement-api:taco-0.1.0
        nova_scheduler: admin-prd:5000/stein/ubuntu-source-nova-scheduler:taco-0.1.0
        nova_spiceproxy: admin-prd:5000/stein/ubuntu-source-nova-spicehtml5proxy:taco-0.1.0
        nova_spiceproxy_assets: admin-prd:5000/stein/ubuntu-source-nova-spicehtml5proxy:taco-0.1.0
        bootstrap: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
        rabbit_init: admin-prd:5000/rabbitmq:3.7-management
        nova_service_cleaner: admin-prd:5000/port/ceph-config-helper:v1.17.6
        nova_wait_for_computes_init: admin-prd:5000/google_containers/hyperkube-amd64:v1.11.6
      pull_policy: Always
    bootstrap:
      structured:
        flavors:
          enabled: true
          options:
            m1_tiny:
              id: 0c84e220-a258-439f-a6ff-f8e9fd980025
    network:
      backend:
      - linuxbridge
      novncproxy:
        name: nova-novncproxy
        node_port:
          enabled: true
          port: 30608
    conf:
      hypervisor:
        host_interface: enp3s0f0
      libvirt:
        live_migration_interface: bond0
      ceph:
        enabled: true
        admin_keyring: TACO_ADMIN_KEYRING
        cinder:
          user: cinder
          keyring: AQAin8tU0CFgEhAATb7sYgtWsh+S5HEbg6MrGg==
      nova:
        DEFAULT:
          scheduler_default_filters: RetryFilter,AvailabilityZoneFilter,RamFilter,ComputeFilter,ComputeCapabilitiesFilter,ImagePropertiesFilter,ServerGroupAntiAffinityFilter,ServerGroupAffinityFilter
          debug: true
          config_drive_cdrom: true
          config_drive_format: iso9660
          force_config_drive: true
          ram_allocation_ratio: 1.0
          disk_allocation_ratio: 9999.0
          cpu_allocation_ratio: 8.0
          osapi_compute_workers: 8
        vnc:
          novncproxy_base_url: http://192.168.95.19:30608/vnc_auto.html
        libvirt:
          images_type: rbd
          rbd_user: cinder
          rbd_secret_uuid: 582393ff-9a5c-4a2e-ae0d-86ec18c36afc
        scheduler:
          discover_hosts_in_cells_interval: 60
        placement_database:
          max_retries: -1
          sync_on_startup: true
        placement:
          region_name: RegionOne
      rootwrap_filters: null
    pod:
      mandatory_access_control:
        type: null
      user:
        nova:
          uid: 42436
      security_context:
        nova:
          pod:
            runAsUser: 42436
      replicas:
        api_metadata: 3
        placement: 3
        osapi: 3
        conductor: 3
        consoleauth: 3
        scheduler: 3
        novncproxy: 3
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm
    subpath: nova
    reference: master
  test:
    enabled: true
    timeout: 3600
  dependencies:
  - helm-toolkit
---
schema: armada/ChartGroup/v1
metadata:
  schema: metadata/Document/v1
  name: openstack-addon
data:
  description: "Openstack Addon Services"
  sequenced: False
  chart_group:
    - horizon
    - heat
---
schema: armada/ChartGroup/v1
metadata:
  schema: metadata/Document/v1
  name: openstack-base
data:
  description: "Openstack Base Services"
  sequenced: False
  chart_group:
    - keystone
    - glance
    - cinder
---
schema: armada/ChartGroup/v1
metadata:
  schema: metadata/Document/v1
  name: openstack-compute-kit
data:
  description: "Openstack Compute Services"
  sequenced: False
  chart_group:
    - libvirt
    - openvswitch
    - nova
    - neutron
---
schema: armada/ChartGroup/v1
metadata:
  schema: metadata/Document/v1
  name: openstack-infra
data:
  description: "Openstack Infrastructures"
  sequenced: False
  chart_group:
    - ceph-provisioners
    - ingress
    - memcached
    - rabbitmq
    - mariadb
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: openvswitch
data:
  chart_name: openvswitch
  release: openvswitch
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
  values:
    endpoints:
      cluster_domain_suffix: cluster.local
    release_group: null
    images:
      tags:
        openvswitch_db_server: admin-prd:5000/stein/ubuntu-source-openvswitch-db-server:taco-0.1.0
        openvswitch_vswitchd: admin-prd:5000/stein/ubuntu-source-openvswitch-vswitchd:taco-0.1.0
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        image_repo_sync: admin-prd:5000/docker:17.07.0
      pull_policy: Always
    pod:
      security_context:
        openvswitch_db_server:
          pod:
            runAsUser: 0
          container:
            server:
              runAsUser: 0
      user:
        nova:
          uid: 42436
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: openvswitch
    reference: master
  dependencies:
    - helm-toolkit
---
schema: armada/Chart/v1
metadata:
  schema: metadata/Document/v1
  name: rabbitmq
data:
  chart_name: rabbitmq
  release: rabbitmq
  namespace: openstack
  install:
    no_hooks: false
  upgrade:
    no_hooks: false
  values:
    endpoints:
      oslo_messaging:
        auth:
          user:
            username: rabbitmq
            password: password
    images:
      tags:
        prometheus_rabbitmq_exporter: admin-prd:5000/kbudde/rabbitmq-exporter:v0.21.0
        prometheus_rabbitmq_exporter_helm_tests: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        rabbitmq_init: admin-prd:5000/stein/ubuntu-source-heat-engine:taco-0.1.0
        rabbitmq: admin-prd:5000/rabbitmq:3.7.13
        dep_check: admin-prd:5000/airshipit/kubernetes-entrypoint:v1.0.0
        scripted_test: admin-prd:5000/rabbitmq:3.7.13-management
        image_repo_sync: admin-prd:5000/docker:17.07.0
      pull_policy: IfNotPresent
    pod:
      replicas:
        server: 3
    volume:
      class_name: rbd
    monitoring:
      prometheus:
        enabled: true
        rabbitmq_exporter:
          scrape: true
  source:
    type: local
    location: /home/taco/tacoplay/charts/openstack-helm-infra
    subpath: rabbitmq
    reference: master
  test:
    enabled: true
    timeout: 3600
  dependencies:
  - helm-toolkit
